<!DOCTYPE html>
<head>
        <title>S.M.E.K. Fitness Group</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="marquee.css">
        <link rel="stylesheet" href="FitnessProg.css">
</head>
<body>
        <nav class="navbar">
                <div class="nav-left">
                        <a href="products.html" class="nav-item">Shop</a>
                        <a href="FitnessProg.html" class="nav-item">Fitness Program</a>
                        <a href="contact.html" class="nav-item">Contact Us</a>
                </div>
                <div class="nav-center">
                        <a href="https://kprou.github.io/CS20SMEKFitnessFinal/" class="nav-logo">
                                <img src="smek-low-resolution-logo-black-on-transparent-background.png" style="height: 75px;">
                        </a>
                </div>
                <div class="nav-right">
                        <a href="#" class="nav-item">About Us</a>
                        <a href="#" class="nav-item">Sign In</a>
                </div>
        </nav>

        <div class="sloganContainer">
                <h1 class="slogan">Planned workouts, exclusive instruction, private instructor, and community</h1>
        </div>

        <div class="progDescriptionContainer">
                <h5 class="progDescription">
                        Fitness For All: Our specialized coaches are experts in their fields. What you will get when you sign up with us are exclusive products that we personally take and we want to share that with the community. Coach Silas specializes in Baseball, Coach Maddy specializes in Track and Field, Coach Eric specializes in Basketball, and Coach Kevin specializes in Powerlifting. While the coaches are specialized in these fields, they still have a solid understanding how to achieve any fitness goal imaginable! 
                </h5>
        </div>

        <div class="main"> 
		<input type="checkbox" id="chk" aria-hidden="true">
                <div class="signup">
                        <form id="register-form">
                                <label for="chk" aria-hidden="true">Sign up</label>
                                <input type="text" name="txt" placeholder="User name" required="">
                                <input type="password" name="pswd" placeholder="Password" required="">
                                <button class="SignButton" type="submit">Sign up</button>
                        </form>
                </div>
                <div class="login">
                        <form id="login-form">
                                <label for="chk" aria-hidden="true">Login</label>
                                <input type="text" name="text" placeholder="User name" required="">
                                <input type="password" name="pswd" placeholder="Password" required="">
                                <button class="SignButton" type="submit">Login</button>
                        </form>
                </div>
	</div>

        <footer>
                <div class="stripe">&nbsp</div>
                <img src="smek_logo.png" class="logo">
                <div>An upper class athletic facility located on the campus of Tufts University</div>
                <div>Medford/Somerville, MA</div>
                <br>
                <p>Founded by Silas Reed, Madelyn Silveira, Eric Zhao, and Kevin Prou</p>
                <br>
        </footer>

        <script>
                function getCookie(name) {
                        const nameEQ = `${name}=`;
                        const cookies = document.cookie.split(';');
                        for (let i = 0; i < cookies.length; i++) {
                                let cookie = cookies[i];
                                while (cookie.charAt(0) === ' ') {
                                        cookie = cookie.substring(1, cookie.length);
                                }
                                if (cookie.indexOf(nameEQ) === 0) {
                                        return cookie.substring(nameEQ.length, cookie.length);
                                }
                        }
                        return null;
                }

                // Check if the user is logged in
                if (getCookie('loggedIn') === 'true') {
                        window.location.href = 'index.html';
                }

                const registerForm = document.getElementById('register-form');
                const loginForm = document.getElementById('login-form');
            
                // Register form submission
                registerForm.addEventListener('submit', (event) => {
                        event.preventDefault();
                        const username = registerForm.querySelector('[name="txt"]').value;
                        const password = registerForm.querySelector('[name="pswd"]').value;
                
                        fetch('/register', {
                                method: 'POST',
                                headers: {
                                        'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ username, password })
                        })
                        .then(response => response.text())
                        .then(message => alert(message))
                        .catch(error => console.error(error));
                });

                function setCookie(name, value, days) {
                        const date = new Date();
                        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                        const expires = `; expires=${date.toUTCString()}`;
                        document.cookie = `${name}=${value}${expires}; path=/`;
                }
            
                // Login form submission
                loginForm.addEventListener('submit', (event) => {
                        event.preventDefault();
                        const username = registerForm.querySelector('[name="txt"]').value;
                        const password = registerForm.querySelector('[name="pswd"]').value;
                
                        fetch('/login', {
                                method: 'POST',
                                headers: {
                                        'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ username, password })
                        })
                        .then(response => {
                                if (response.status === 200) {
                                        setCookie('loggedIn', 'true', 1);
                                        window.location.href = 'index.html';
                                } else {
                                        return response.text();
                                }
                        })
                        .then(message => {
                                if (message) {
                                        alert(message);
                                }
                        })
                        .catch(error => console.error(error));
                });
        </script>

</body>
</html>
